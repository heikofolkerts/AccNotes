<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AccNotes - Übersicht aller Barrierefreiheits-Notizen">
    <title>Notizen-Übersicht - AccNotes</title>
    <link rel="stylesheet" href="styles/modern-theme.css">
</head>
<body>
    <!-- Skip link for screen reader users -->
    <a href="#main-content" class="skip-link">Zum Hauptinhalt springen</a>

    <!-- Theme Toggle -->
    <button class="theme-toggle" aria-label="Zwischen hellem und dunklem Design wechseln" title="Design wechseln" id="theme-toggle">
        <span aria-hidden="true">🌓</span>
    </button>

    <main id="main-content" class="container">
        <header>
            <h1>📋 Barrierefreiheits-Notizen Übersicht</h1>
        </header>

        <!-- Statistics Section -->
        <section aria-labelledby="stats-title">
            <h2 id="stats-title" class="sr-only">Statistiken</h2>
            <ul class="stats-list" aria-label="Notizen-Statistiken">
                <li class="stats-list__item">
                    <span class="stats-list__label">Notizen gesamt:</span>
                    <span class="stats-list__value" id="total-notes">0</span>
                </li>
                <li class="stats-list__item">
                    <span class="stats-list__label">Notizen heute:</span>
                    <span class="stats-list__value" id="notes-today">0</span>
                </li>
                <li class="stats-list__item">
                    <span class="stats-list__label">Eindeutige Seiten:</span>
                    <span class="stats-list__value" id="unique-pages">0</span>
                </li>
                <li class="stats-list__item">
                    <span class="stats-list__label">BITV-Tests:</span>
                    <span class="stats-list__value" id="bitv-notes">0</span>
                </li>
                <li class="stats-list__item">
                    <span class="stats-list__label">Nicht bestanden:</span>
                    <span class="stats-list__value" id="failed-tests">0</span>
                </li>
            </ul>
        </section>

        <!-- BITV Progress Dashboard -->
        <section class="info-panel" aria-labelledby="bitv-progress-title" id="bitv-dashboard" style="display: none;">
            <h2 id="bitv-progress-title" class="info-panel__title">📊 BITV-Fortschritt</h2>
            <div id="bitv-progress-container">
                <!-- Progress bars will be generated here -->
            </div>
        </section>

        <!-- Storage Statistics Section -->
        <section class="info-panel" aria-labelledby="storage-title" id="storage-stats" style="display: none;">
            <h2 id="storage-title" class="info-panel__title">💾 Speicher-Statistiken</h2>
            <div class="storage-info">
                <div class="storage-stat">
                    <span class="storage-stat__label">Speicherverbrauch:</span>
                    <span class="storage-stat__value" id="storage-usage">-</span>
                </div>
                <div class="storage-stat">
                    <span class="storage-stat__label">Status:</span>
                    <span class="storage-stat__value" id="storage-status">chrome.storage.local</span>
                </div>
            </div>
        </section>

        <!-- Export Section -->
        <section class="info-panel" aria-labelledby="export-title">
            <h2 id="export-title" class="info-panel__title">📥 Export & Verwaltung</h2>
            <div class="controls">
                <div class="controls__group">
                    <button type="button" onclick="exportAllNotes()" class="btn btn--secondary">
                        <span aria-hidden="true">📦</span>
                        Alle als ZIP exportieren
                    </button>
                    <button type="button" onclick="exportFilteredNotes()" class="btn btn--secondary">
                        <span aria-hidden="true">🎯</span>
                        Gefilterte exportieren
                    </button>
                    <button type="button" onclick="exportNotesAsCSV()" class="btn btn--secondary">
                        <span aria-hidden="true">📊</span>
                        Als CSV exportieren
                    </button>
                    <button type="button" onclick="exportBitvReport()" class="btn btn--primary">
                        <span aria-hidden="true">✅</span>
                        BITV-Bericht exportieren
                    </button>
                </div>
                <div class="controls__group">
                    <button type="button" onclick="bulkDeleteFiltered()" class="btn btn--warning"
                            aria-describedby="bulk-delete-help">
                        <span aria-hidden="true">🎯🗑️</span>
                        Gefilterte löschen
                    </button>
                    <button type="button" onclick="clearAllNotes()" class="btn btn--danger"
                            aria-describedby="clear-help">
                        <span aria-hidden="true">🗑️</span>
                        Alle löschen
                    </button>
                    <div id="bulk-delete-help" class="sr-only">Löscht alle Notizen, die den aktuellen Filterkriterien entsprechen</div>
                    <div id="clear-help" class="sr-only">Löscht alle gespeicherten Notizen unwiderruflich</div>
                </div>
            </div>
        </section>

        <!-- Filter and Sort Controls -->
        <section aria-labelledby="filter-title">
            <h2 id="filter-title" class="sr-only">Filter und Sortierung</h2>
            <div class="controls">
                <div class="controls__group">
                    <button type="button" id="refresh-notes-btn" class="btn btn--secondary">
                        <span aria-hidden="true">🔄</span>
                        Aktualisieren
                    </button>

                    <label for="sort-select" class="form-label">Sortierung:</label>
                    <select id="sort-select" class="form-select" style="width: auto;">
                        <option value="newest">Neueste zuerst</option>
                        <option value="oldest">Älteste zuerst</option>
                        <option value="page">Nach Seite</option>
                        <option value="bitv-step">Nach BITV-Prüfschritt</option>
                        <option value="evaluation">Nach Bewertung</option>
                    </select>
                </div>

                <div class="controls__group">
                    <label for="search-input" class="form-label">Suche:</label>
                    <input type="search"
                           id="search-input"
                           class="form-input"
                           style="width: 250px;"
                           placeholder="Notizen durchsuchen..."
                           aria-describedby="search-help">
                    <div id="search-help" class="sr-only">Durchsucht Titel, URL, Inhalt und BITV-Prüfschritte</div>
                </div>
            </div>

            <!-- BITV Filter Controls -->
            <div class="controls bitv-filters">
                <div class="controls__group">
                    <label for="bitv-category-filter" class="form-label">BITV-Kategorie:</label>
                    <select id="bitv-category-filter" class="form-select" style="width: auto;">
                        <option value="">Alle Kategorien</option>
                    </select>
                </div>

                <div class="controls__group">
                    <label for="bitv-evaluation-filter" class="form-label">Bewertung:</label>
                    <select id="bitv-evaluation-filter" class="form-select" style="width: auto;">
                        <option value="">Alle Bewertungen</option>
                        <option value="passed">✅ Bestanden</option>
                        <option value="failed">❌ Nicht bestanden</option>
                        <option value="partial">⚠️ Teilweise bestanden</option>
                        <option value="needs_review">📝 Zu überprüfen</option>
                    </select>
                </div>

                <div class="controls__group">
                    <label for="notes-type-filter" class="form-label">Typ:</label>
                    <select id="notes-type-filter" class="form-select" style="width: auto;">
                        <option value="">Alle Notizen</option>
                        <option value="bitv">Nur BITV-Tests</option>
                        <option value="general">Nur allgemeine Notizen</option>
                    </select>
                </div>

                <div class="controls__group">
                    <label for="website-filter" class="form-label">Website:</label>
                    <select id="website-filter" class="form-select" style="width: auto;">
                        <option value="">Alle Websites</option>
                    </select>
                </div>

                <div class="controls__group">
                    <label for="status-filter" class="form-label">Status:</label>
                    <select id="status-filter" class="form-select" style="width: auto;">
                        <option value="">Alle Status</option>
                        <option value="draft">📝 Entwürfe</option>
                        <option value="reported">📧 Gemeldete</option>
                        <option value="resolved">✅ Behobene</option>
                        <option value="unreported">🔄 Nicht gemeldete (Entwurf + Behoben)</option>
                    </select>
                </div>

                <div class="controls__group">
                    <button type="button" id="clear-filters-btn" class="btn btn--secondary btn--small">
                        <span aria-hidden="true">🗑️</span>
                        Filter zurücksetzen
                    </button>
                </div>
            </div>
        </section>

        <!-- Bulk Selection Controls -->
        <section class="info-panel" aria-labelledby="bulk-selection-title" id="bulk-selection-section" style="display: none;">
            <h2 id="bulk-selection-title" class="info-panel__title">✅ Mehrfachauswahl</h2>
            <div class="controls">
                <div class="controls__group">
                    <label class="checkbox-label checkbox-label--prominent">
                        <input type="checkbox" id="select-all-checkbox" class="checkbox-input" aria-describedby="select-all-help">
                        <span class="checkbox-text">Alle auswählen</span>
                    </label>
                    <div id="select-all-help" class="sr-only">Wählt alle sichtbaren Notizen aus oder hebt die Auswahl auf</div>
                </div>
                <div class="controls__group">
                    <button type="button" id="bulk-action-button" class="btn btn--primary" disabled aria-describedby="bulk-action-help">
                        <span aria-hidden="true">📄</span>
                        <span id="bulk-action-text">Auswahl als PDF exportieren (0)</span>
                    </button>
                    <button type="button" id="bulk-action-html-button" class="btn btn--secondary" disabled aria-describedby="bulk-action-html-help">
                        <span aria-hidden="true">📄</span>
                        <span id="bulk-action-html-text">Auswahl als HTML exportieren (0)</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Email Template Section -->
        <section class="info-panel" aria-labelledby="email-template-title">
            <h2 id="email-template-title" class="info-panel__title">📧 E-Mail-Vorlage für Behördenmeldungen</h2>
            <div class="controls">
                <div class="controls__group">
                    <button type="button" id="email-draft-button" class="btn btn--secondary">
                        <span aria-hidden="true">📧</span>
                        E-Mail-Entwurf öffnen
                    </button>
                    <button type="button" id="email-copy-button" class="btn btn--secondary">
                        <span aria-hidden="true">📋</span>
                        E-Mail-Text kopieren
                    </button>
                    <div id="email-help" class="sr-only">Öffnet eine E-Mail-Vorlage für die Meldung von Barrierefreiheitsproblemen gemäß BFSG. Fügen Sie den PDF- oder HTML-Export als Anhang hinzu.</div>
                </div>
            </div>
        </section>

        <!-- Notes List -->
        <section aria-labelledby="notes-title">
            <h2 id="notes-title" class="sr-only">Notizen-Liste</h2>
            <div id="notes-container" role="region" aria-live="polite" aria-label="Notizen-Liste">
                <div class="no-notes">
                    <p>📝 Keine Notizen gefunden.</p>
                    <p>Erstellen Sie Ihre erste Notiz über das Kontextmenü!</p>
                </div>
            </div>
        </section>
    </main>

    <script src="scripts/theme-toggle.js"></script>
    <script src="scripts/bitv-catalog.js"></script>
    <script src="scripts/storage-helper.js"></script>
    <script src="scripts/libs/jspdf.umd.min.js"></script>
    <script src="notes-overview.js"></script>
</body>
</html>