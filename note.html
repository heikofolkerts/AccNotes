<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AccNotes - Barrierefreiheits-Notiz erstellen">
    <title>Notiz hinzuf√ºgen - AccNotes</title>
    <link rel="stylesheet" href="styles/modern-theme.css">
</head>
<body>
    <!-- Skip link for screen reader users -->
    <a href="#main-content" class="skip-link">Zum Hauptinhalt springen</a>

    <!-- Theme Toggle -->
    <button class="theme-toggle" aria-label="Zwischen hellem und dunklem Design wechseln" title="Design wechseln" id="theme-toggle">
        <span aria-hidden="true">üåì</span>
    </button>

    <main id="main-content" class="container container--narrow">
        <header>
            <h1>üìù Neue Barrierefreiheits-Notiz</h1>
        </header>

        <!-- Context Information Panel -->
        <section class="info-panel" aria-labelledby="context-title">
            <h2 id="context-title" class="info-panel__title">üîç Kontext-Informationen</h2>
            <div id="context-details">

                <!-- Page Information -->
                <details class="section" open>
                    <summary class="section__title">
                        <span aria-hidden="true">üåê</span> Seiten-Informationen
                    </summary>
                    <dl>
                        <dt>URL:</dt>
                        <dd id="page-url" class="font-mono">-</dd>
                        <dt>Seitentitel:</dt>
                        <dd id="page-title">-</dd>
                        <dt>Ausgew√§hlter Text:</dt>
                        <dd id="selected-text">-</dd>
                    </dl>
                </details>

                <!-- Element Information -->
                <details class="section" open>
                    <summary class="section__title">
                        <span aria-hidden="true">üéØ</span> Element-Informationen
                    </summary>
                    <dl>
                        <dt>Element-Typ:</dt>
                        <dd id="element-type">-</dd>
                        <dt>HTML-Tag:</dt>
                        <dd id="tag-name" class="font-mono">-</dd>
                        <dt>Text/Inhalt:</dt>
                        <dd id="element-text">-</dd>
                        <dt>ID-Attribut:</dt>
                        <dd id="element-id" class="font-mono">-</dd>
                        <dt>CSS-Klassen:</dt>
                        <dd id="element-class" class="font-mono">-</dd>
                    </dl>
                </details>

                <!-- Accessibility Information -->
                <details class="section" open>
                    <summary class="section__title">
                        <span aria-hidden="true">‚ôø</span> Barrierefreiheit (ARIA)
                    </summary>
                    <dl>
                        <dt>Zug√§nglicher Name:</dt>
                        <dd id="accessible-name">-</dd>
                        <dt>Zug√§ngliche Beschreibung:</dt>
                        <dd id="accessible-description">-</dd>
                        <dt>ARIA-Label:</dt>
                        <dd id="aria-label" class="font-mono">-</dd>
                        <dt>ARIA-Role:</dt>
                        <dd id="aria-role" class="font-mono">-</dd>
                        <dt>ARIA-Hidden:</dt>
                        <dd id="aria-hidden" class="font-mono">-</dd>
                        <dt>ARIA-Expanded:</dt>
                        <dd id="aria-expanded" class="font-mono">-</dd>
                        <dt>ARIA-Pressed:</dt>
                        <dd id="aria-pressed" class="font-mono">-</dd>
                        <dt>ARIA-Checked:</dt>
                        <dd id="aria-checked" class="font-mono">-</dd>
                        <dt>ARIA-Disabled:</dt>
                        <dd id="aria-disabled" class="font-mono">-</dd>
                        <dt>ARIA-Required:</dt>
                        <dd id="aria-required" class="font-mono">-</dd>
                    </dl>
                </details>

                <!-- Interaction & Focus -->
                <details class="section">
                    <summary class="section__title">
                        <span aria-hidden="true">‚ö°</span> Interaktion & Fokus
                    </summary>
                    <dl>
                        <dt>Ist interaktiv:</dt>
                        <dd id="is-interactive">-</dd>
                        <dt>Ist fokussierbar:</dt>
                        <dd id="is-focusable">-</dd>
                        <dt>Tab-Index:</dt>
                        <dd id="tab-index" class="font-mono">-</dd>
                        <dt>Deaktiviert:</dt>
                        <dd id="disabled">-</dd>
                    </dl>
                </details>

                <!-- Link Information -->
                <details class="section">
                    <summary class="section__title">
                        <span aria-hidden="true">üîó</span> Link-Informationen
                    </summary>
                    <dl>
                        <dt>Link-URL:</dt>
                        <dd id="link-url" class="font-mono">-</dd>
                        <dt>Link-Ziel:</dt>
                        <dd id="link-target" class="font-mono">-</dd>
                    </dl>
                </details>

                <!-- Form Information -->
                <details class="section">
                    <summary class="section__title">
                        <span aria-hidden="true">üìù</span> Formular-Informationen
                    </summary>
                    <dl>
                        <dt>Name-Attribut:</dt>
                        <dd id="form-name" class="font-mono">-</dd>
                        <dt>Type-Attribut:</dt>
                        <dd id="form-type" class="font-mono">-</dd>
                        <dt>Aktueller Wert:</dt>
                        <dd id="form-value">-</dd>
                        <dt>Placeholder-Text:</dt>
                        <dd id="placeholder">-</dd>
                        <dt>Erforderlich:</dt>
                        <dd id="required">-</dd>
                    </dl>
                </details>

                <!-- Technical Details -->
                <details class="section">
                    <summary class="section__title">
                        <span aria-hidden="true">üîß</span> Technische Details
                    </summary>
                    <dl>
                        <dt>CSS-Selector:</dt>
                        <dd id="css-selector" class="font-mono">-</dd>
                        <dt>XPath:</dt>
                        <dd id="xpath" class="font-mono">-</dd>
                    </dl>
                </details>

            </div>
        </section>

        <!-- Simplified Citizen Report Mode -->
        <section class="info-panel" id="simplified-mode-section" style="display: none;" aria-labelledby="simplified-mode-title">
            <h2 id="simplified-mode-title" class="info-panel__title">üöÄ Schnelle B√ºrgermeldung</h2>

            <div class="alert alert--info" role="status">
                <span aria-hidden="true">‚ÑπÔ∏è</span>
                <div>
                    <strong>Vereinfachter Modus aktiv:</strong> Sie m√ºssen keine technischen BITV-Kenntnisse haben.
                    Beschreiben Sie einfach das Problem in Ihren eigenen Worten.
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <span aria-hidden="true">üö®</span> Erkanntes Problem:
                </label>
                <div id="detected-problem-display" class="info-box info-box--warning">
                    <strong id="detected-problem-title">Problem wird geladen...</strong>
                    <p id="detected-problem-description">Beschreibung wird geladen...</p>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <span aria-hidden="true">üìç</span> Wo befindet sich das Problem?
                </label>
                <div id="problem-location-display" class="info-box">
                    <dl class="compact-dl">
                        <dt>Website:</dt>
                        <dd id="simple-page-url" class="font-mono">-</dd>
                        <dt>Seite:</dt>
                        <dd id="simple-page-title">-</dd>
                        <dt>Element:</dt>
                        <dd id="simple-element-type">-</dd>
                    </dl>
                </div>
            </div>

            <div class="form-group">
                <button type="button" id="switch-to-detailed-mode" class="button-secondary">
                    üìã Zu detailliertem Modus wechseln
                </button>
                <div class="form-help">
                    <small>F√ºr BITV-Experten: Wechseln Sie zum detaillierten Modus mit vollst√§ndiger BITV-Pr√ºfschritt-Auswahl.</small>
                </div>
            </div>
        </section>

        <!-- BITV Test Selection (Detailed Mode) -->
        <section class="info-panel" id="bitv-mode-section" aria-labelledby="bitv-section-title">
            <h2 id="bitv-section-title" class="info-panel__title">‚úÖ BITV-Pr√ºfschritt</h2>

            <div class="form-group">
                <label for="bitv-category" class="form-label">
                    Kategorie ausw√§hlen:
                </label>
                <select id="bitv-category" class="form-select" aria-describedby="bitv-category-help">
                    <option value="">-- Bitte Kategorie w√§hlen --</option>
                </select>
                <div id="bitv-category-help" class="form-help">
                    <small>W√§hlen Sie die passende BITV-Kategorie f√ºr Ihre Beobachtung aus.</small>
                </div>
            </div>

            <div class="form-group">
                <label for="bitv-step" class="form-label">
                    Pr√ºfschritt ausw√§hlen:
                </label>
                <select id="bitv-step" class="form-select" aria-describedby="bitv-step-help" disabled>
                    <option value="">-- Erst Kategorie w√§hlen --</option>
                </select>
                <div id="bitv-step-help" class="form-help">
                    <small>W√§hlen Sie den spezifischen Pr√ºfschritt aus, der f√ºr diese Notiz relevant ist.</small>
                </div>
            </div>

            <div id="bitv-step-details" class="section" style="display: none;">
                <h3 class="section__title">üìã Pr√ºfschritt-Details</h3>
                <dl>
                    <dt>Titel:</dt>
                    <dd id="step-title">-</dd>
                    <dt>Beschreibung:</dt>
                    <dd id="step-description">-</dd>
                    <dt>Level:</dt>
                    <dd id="step-level">-</dd>
                </dl>
            </div>

            <div class="form-group" id="evaluation-group" style="display: none;">
                <fieldset>
                    <legend class="form-label">Bewertung f√ºr diesen Pr√ºfschritt:</legend>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="evaluation" value="passed" class="radio-input">
                            <span class="radio-indicator" aria-hidden="true">‚úÖ</span>
                            Bestanden
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="evaluation" value="failed" class="radio-input">
                            <span class="radio-indicator" aria-hidden="true">‚ùå</span>
                            Nicht bestanden
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="evaluation" value="partial" class="radio-input">
                            <span class="radio-indicator" aria-hidden="true">‚ö†Ô∏è</span>
                            Teilweise bestanden
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="evaluation" value="needs_review" class="radio-input">
                            <span class="radio-indicator" aria-hidden="true">üìù</span>
                            Zu √ºberpr√ºfen
                        </label>
                    </div>
                </fieldset>
            </div>
        </section>

        <!-- Note Form -->
        <section aria-labelledby="note-form-title">
            <h2 id="note-form-title" class="sr-only">Notiz erstellen</h2>

            <form id="note-form" novalidate>
                <div class="form-group">
                    <label for="note-title" class="form-label">
                        Titel der Notiz:
                        <span class="sr-only">(Erforderlich)</span>
                    </label>
                    <input
                        type="text"
                        id="note-title"
                        class="form-input"
                        placeholder="Kurzer, aussagekr√§ftiger Titel..."
                        required
                        aria-describedby="title-help">
                    <div id="title-help" class="form-help">
                        <small>Geben Sie einen aussagekr√§ftigen Titel f√ºr diese Accessibility-Beobachtung ein.</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="note-content" class="form-label">
                        Detaillierte Beschreibung:
                        <span class="sr-only">(Erforderlich)</span>
                    </label>
                    <textarea
                        id="note-content"
                        class="form-textarea form-input--large"
                        placeholder="Beschreiben Sie hier Ihre Beobachtungen zur Barrierefreiheit..."
                        required
                        aria-describedby="note-help"
                        spellcheck="true"></textarea>
                    <div id="note-help" class="form-help">
                        <small>Beschreiben Sie das Problem, geben Sie Verbesserungsvorschl√§ge und verweisen Sie auf relevante BITV-Kriterien.</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="recommendation" class="form-label">
                        Empfehlung:
                    </label>
                    <textarea
                        id="recommendation"
                        class="form-textarea"
                        placeholder="Konkrete Vorschl√§ge zur Verbesserung der Barrierefreiheit..."
                        aria-describedby="recommendation-help"
                        spellcheck="true"></textarea>
                    <div id="recommendation-help" class="form-help">
                        <small>Geben Sie konkrete, umsetzbare Empfehlungen zur Behebung des Problems.</small>
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="include-screenshot" class="checkbox-input">
                        <span class="checkbox-indicator" aria-hidden="true">üì∑</span>
                        Screenshot des Problems mit der Notiz speichern
                    </label>
                    <div id="screenshot-help" class="form-help">
                        <small>Ein Screenshot kann helfen, das Problem visuell zu dokumentieren. Der Screenshot wird automatisch erstellt und mit der Notiz gespeichert.</small>
                    </div>
                    <div id="screenshot-preview" class="screenshot-preview" style="display: none;">
                        <h3 class="screenshot-preview__title">üì∑ Screenshot-Vorschau</h3>
                        <div class="screenshot-preview__container">
                            <canvas id="screenshot-canvas" class="screenshot-preview__canvas"></canvas>
                        </div>
                        <div class="screenshot-preview__info">
                            <small id="screenshot-info">Screenshot wird beim Speichern erstellt...</small>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button type="button" id="cancel-button" class="btn btn--secondary">
                        <span aria-hidden="true">‚ùå</span>
                        Abbrechen
                    </button>
                    <button type="submit" id="save-button" class="btn btn--primary">
                        <span aria-hidden="true">üíæ</span>
                        Notiz speichern
                    </button>
                </div>
            </form>
        </section>
    </main>

    <script src="scripts/theme-toggle.js"></script>
    <script src="scripts/bitv-catalog.js"></script>
    <script src="scripts/storage-helper.js"></script>
    <script src="scripts/screenshot-helper.js"></script>
    <script src="note.js"></script>
</body>
</html>